<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="GenAI Bench Team" /><link rel="canonical" href="https://github.com/sgl-project/genai-bench/user-guide/metrics/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Benchmark Metrics Definition - GenAI Bench</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Benchmark Metrics Definition";
        var mkdocs_page_input_path = "user-guide/metrics.md";
        var mkdocs_page_url = "/sgl-project/genai-bench/user-guide/metrics/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/json.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> GenAI Bench
        </a>
        <div class="version">
          1.0.0
        </div><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">User Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting-started/installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tasks/">Tasks & Metrics</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Examples</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/basic-benchmarks/">Basic Benchmarks</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../api/overview/">API Reference</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">GenAI Bench</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Benchmark Metrics Definition</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/sgl-project/genai-bench/edit/main/docs/user-guide/metrics.md">Edit on sgl-project/genai-bench</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="benchmark-metrics-definition"><a class="toclink" href="#benchmark-metrics-definition">Benchmark Metrics Definition</a><a class="headerlink" href="#benchmark-metrics-definition" title="Permanent link">&para;</a></h1>
<p>This section puts together the standard metrics required for LLM serving performance analysis. We classify metrics to two types: <strong>single-request level metrics</strong>, representing the metrics collected from one request. And <strong>aggregated level metrics</strong>, summarizing the single-request metrics from one run (with specific traffic scenario and num concurrency).</p>
<p><strong>NOTE</strong>:</p>
<ul>
<li>Each single-request metric includes standard statistics: <strong>percentile</strong>, <strong>min</strong>, <strong>max</strong>, <strong>stddev</strong>, and <strong>mean</strong>.</li>
<li>The following metrics cover <strong>input</strong>, <strong>output</strong>, and <strong>end-to-end (e2e)</strong> stages. For <em>chat</em> tasks, all stages are relevant for evaluation. For <em>embedding</em> tasks, where there is no output stage, output metrics will be set to 0.</li>
</ul>
<h2 id="single-request-level-metrics"><a class="toclink" href="#single-request-level-metrics">Single Request Level Metrics</a><a class="headerlink" href="#single-request-level-metrics" title="Permanent link">&para;</a></h2>
<p>The following metrics capture token-level performance for a single request, providing insights into server efficiency for each individual request.</p>
<table>
<thead>
<tr>
<th>Glossary</th>
<th>Meaning</th>
<th>Calculation Formula</th>
<th>Units</th>
</tr>
</thead>
<tbody>
<tr>
<td>TTFT</td>
<td>Time to First Token. Initial response time when the first output token is generated. <br/> This is also known as the latency for the input (input) stage.</td>
<td><code>ttft = time_at_first_token - start_time</code></td>
<td>seconds</td>
</tr>
<tr>
<td>End-to-End Latency</td>
<td>End-to-End latency. This metric indicates how long it takes from submitting a query to receiving the full response, including network latencies.</td>
<td><code>e2e_latency = end_time - start_time</code></td>
<td>seconds</td>
</tr>
<tr>
<td>TPOT</td>
<td>Time Per Output Token. The average time between two subsequent generated tokens.</td>
<td><code>TPOT = (e2e_latency - TTFT) / (num_output_tokens - 1)</code></td>
<td>seconds</td>
</tr>
<tr>
<td>Output Inference Speed</td>
<td>The rate of how many tokens the model can generate per second for a single request.</td>
<td><code>inference_speed = 1 / TPOT</code></td>
<td>tokens/second</td>
</tr>
<tr>
<td>Num of Input Tokens</td>
<td>Number of prompt tokens.</td>
<td><code>num_input_tokens = tokenizer.encode(prompt)</code></td>
<td>tokens</td>
</tr>
<tr>
<td>Num of Output Tokens</td>
<td>Number of output tokens.</td>
<td><code>num_output_tokens = num_completion_tokens</code></td>
<td>tokens</td>
</tr>
<tr>
<td>Num of Request Tokens</td>
<td>Total number of tokens processed in one request.</td>
<td><code>num_request_tokens = num_input_tokens + num_output_tokens</code></td>
<td>tokens</td>
</tr>
<tr>
<td>Input Throughput</td>
<td>The overall throughput of input (input process).</td>
<td><code>input_throughput = num_input_tokens / TTFT</code></td>
<td>tokens/second</td>
</tr>
<tr>
<td>Output Throughput</td>
<td>The throughput of output (output generation) for a single request.</td>
<td><code>output_throughput = (num_output_tokens - 1) / output_latency</code></td>
<td>tokens/second</td>
</tr>
</tbody>
</table>
<h2 id="aggregated-metrics"><a class="toclink" href="#aggregated-metrics">Aggregated Metrics</a><a class="headerlink" href="#aggregated-metrics" title="Permanent link">&para;</a></h2>
<p>This metrics collection summarizes the metrics relevant to a specific traffic load pattern, defined by the traffic scenario and the num of concurrency. It provides insights into server capacity and performance under pressure.</p>
<table>
<thead>
<tr>
<th>Glossary</th>
<th>Meaning</th>
<th>Calculation Formula</th>
<th>Units</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mean Input Throughput</td>
<td>The average throughput of how many input tokens can be processed by the model in one run with multiple concurrent requests.</td>
<td><code>mean_input_throughput = sum(input_tokens_for_all_requests) / run_duration</code></td>
<td>tokens/second</td>
</tr>
<tr>
<td>Mean Output Throughput</td>
<td>The average throughput of how many output tokens can be processed by the model in one run with multiple concurrent requests.</td>
<td><code>mean_output_throughput = sum(output_tokens_for_all_requests) / run_duration</code></td>
<td>tokens/second</td>
</tr>
<tr>
<td>Total Tokens Throughput</td>
<td>The average throughput of how many tokens can be processed by the model, including both input and output tokens.</td>
<td><code>mean_total_tokens_throughput = all_requests["total_tokens"]["sum"] / run_duration</code></td>
<td>tokens/second</td>
</tr>
<tr>
<td>Total Chars Per Hour<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></td>
<td>The average total characters can be processed by the model per hour.</td>
<td><code>total_chars_per_hour = total_tokens_throughput * dataset_chars_to_token_ratio * 3600</code></td>
<td>Characters</td>
</tr>
<tr>
<td>Requests Per Minute</td>
<td>The number of requests processed by the model per minute.</td>
<td><code>num_completed_requests_per_min = num_completed_requests / (end_time - start_time) * 60</code></td>
<td>Requests</td>
</tr>
<tr>
<td>Error Codes to Frequency</td>
<td>A map that shows the returned error status code to its frequency.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Error Rate</td>
<td>The rate of error requests over total requests.</td>
<td><code>error_rate = num_error_requests / num_requests</code></td>
<td></td>
</tr>
<tr>
<td>Num of Error Requests</td>
<td>The number of error requests in one load.</td>
<td><pre><code>if requests.status_code != '200': <br/> num_error_requests += 1</code></pre></td>
<td></td>
</tr>
<tr>
<td>Num of Completed Requests</td>
<td>The number of completed requests in one load.</td>
<td><pre><code>if requests.status_code == '200': <br/> num_completed_requests += 1</code></pre></td>
<td></td>
</tr>
<tr>
<td>Num of Requests</td>
<td>The total number of requests processed for one load.</td>
<td><code>total_requests = num_completed_requests + num_error_requests</code></td>
<td></td>
</tr>
</tbody>
</table>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p><em>Total Chars Per Hour</em> is derived from a character-to-token ratio based on sonnet.txt and the model's tokenizer. This metric aids in pricing decisions for an LLM serving solution. For tasks with multi-modal inputs, non-text tokens are converted to an equivalent character count using the same character-to-token ratio.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright &copy; 2024 GenAI Bench Team</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/sgl-project/genai-bench" class="fa fa-code-fork" style="color: #fcfcfc"> sgl-project/genai-bench</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
